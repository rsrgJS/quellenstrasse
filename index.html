<!DOCTYPE html>
<html>
<head>
	
	<!-- browser tab title-->
	<title>Quellenstraße</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>

	<style>
		html, body {
			height: 100%;
			margin: 0;
		}
		#map {
			width: 600px;
			height: 400px;
		}
		#refreshButton {
			position: absolute;
			top: 20px;
			right: 20px;
			padding: 10px;
			z-index: 400;
		}

	</style>

	<style>body { padding: 0; margin: 0; } #map { height: 100%; width: 100vw; }</style>
</head>
<body>

<div id='map'></div>
<button id='refreshButton' onclick="myFunction()">Refresh Button</button>

<script>
	<!-- Button Click Event-->
	function myFunction() {
		// first initialization
		map.locate({setView: true, maxZoom: 16});
	}
	
	<!-- Map fittet to the screen-->
	var map = L.map('map').fitWorld();
	
	<!-- marker icon symbol-->
	var myIcon = L.icon({
    iconUrl: 'my-icon.png',
    iconSize: [32, 37],
    iconAnchor: [17, 35],
    popupAnchor: [1, -18],
	});
	<!-- marker icon symbol-->
	var favicon = L.icon({
    iconUrl: 'favicon.png',
    iconSize: [32, 37],
    iconAnchor: [17, 35],
    popupAnchor: [1, -18],
	});
	<!-- marker icon symbol-->
	var urlicon = L.icon({
    iconUrl: 'green.png',
    iconSize: [24, 40],
    iconAnchor: [12, 40],
    popupAnchor: [0, -39],
	});
	
	<!--background map -->
	L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 21,
		<!--copyroght author-->
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
			'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox/streets-v11',
		tileSize: 512,
		zoomOffset: -1
	}).addTo(map);
	
	var myStyle = {
		"color": "#ff7800",
		"weight": 5,
		"opacity": 0.65
	};	
	<!-- add individual markers-->
	<!-- L.marker([48.17651365432451, 16.360024422044273]).addTo(map) -->
		<!-- .bindPopup("Marker ID: 1").openPopup(); -->
	<!-- L.marker([48.17642512312112, 16.362770710635175]).addTo(map) -->
		<!-- .bindPopup("Marker ID: 2").openPopup(); -->
		
	
	<!-- function to show meta data of geoJSON data-->
	function onEachFeature(feature, layer) {
		layer.bindPopup("<b>" + feature.properties.name + "</b><br>" + feature.properties.height + " m");
	}

	<!-- GPS points in GeoJSON Format -->
	var myGeoJSON = {"type": "FeatureCollection", "features": [
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.711070661, 47.551815101]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P001","height": "9,986"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.710947691, 47.552189586]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P002","height": "9,993"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.710849629, 47.552199706]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P003","height": "9,956"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.710090113, 47.552277651]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P004","height": "9,987"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.709240428, 47.552343839]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P005","height": "9,920"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.709283839, 47.552333909]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P006","height": "9,900"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.708603472, 47.552366276]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P007","height": "9,883"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.707922956, 47.552340302]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P008","height": "9,864"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.707923161, 47.552339837]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P009","height": "9,865"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.707736150, 47.552282266]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P010","height": "9,866"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.707249546, 47.552313428]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P011","height": "9,897"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.706902031, 47.552247005]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P012","height": "9,874"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.706288772, 47.552056843]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P013","height": "9,893"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.705491930, 47.552224106]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P014","height": "9,903"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.707301945, 47.551909900]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P015","height": "9,917"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.708335698, 47.551760038]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P016","height": "9,796"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.709676336, 47.551653491]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P017","height": "9,928"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.711901875, 47.551759230]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P018","height": "9,935"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.712359974, 47.551991636]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P019","height": "9,925"}},
	{"type": "Feature", "geometry": {"type": "Point", "coordinates": [9.709392456, 47.552069048]}, "id": "fef49ce4-ec51-481c-a692-e30f5b2c1290", "properties": {"name": "P020","height": "9,939"}}]}
	
	L.geoJSON(myGeoJSON, {onEachFeature: onEachFeature, pointToLayer: function(feature,latlng){ return L.marker(latlng,{icon: urlicon});}    }).addTo(map)

	<!-- marker variable to hold the user position-->
	var theMarker = {};
	
	<!-- if location found-->
	function onLocationFound(e) {
		var radius = e.accuracy / 2;
		
		<!-- if already postion marked remove current marker-->
		if (theMarker != undefined) {
              		map.removeLayer(theMarker);
        	};
		
		<!-- add user position marker-->
		theMarker = L.circleMarker(e.latlng, 20).addTo(map);
<!--			.bindPopup("You are within " + radius + " meters from this point").openPopup();-->

		<!-- add user postion accuracy buffer-->
		<!-- L.circle(e.latlng, radius).addTo(map);-->

	}

	<!-- if no location found-->
	function onLocationError(e) {
		alert(e.message);
	}

	map.on('locationfound', onLocationFound);
	map.on('locationerror', onLocationError);

	// wrap map.locate in a function    
    function locate() {
		map.locate({setView: false, maxZoom: 16});
    }
	
	// first initialization
	map.locate({setView: true, maxZoom: 16});	
    // call locate every 3 seconds... forever
    setInterval(locate, 3000);
	
</script>



</body>
</html>
